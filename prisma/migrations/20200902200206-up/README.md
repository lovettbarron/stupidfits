# Migration `20200902200206-up`

This migration has been generated by Andrew Lovett-Barron at 9/2/2020, 10:02:06 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Item" DROP COLUMN "qual",
DROP COLUMN "grailId",
ADD COLUMN "archive" boolean   

CREATE TABLE "public"."_FitComponent" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL 
)

CREATE TABLE "public"."_ClosetContent" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL 
)

CREATE UNIQUE INDEX "_FitComponent_AB_unique" ON "public"."_FitComponent"("A", "B")

CREATE INDEX "_FitComponent_B_index" ON "public"."_FitComponent"("B")

CREATE UNIQUE INDEX "_ClosetContent_AB_unique" ON "public"."_ClosetContent"("A", "B")

CREATE INDEX "_ClosetContent_B_index" ON "public"."_ClosetContent"("B")

CREATE UNIQUE INDEX "Brand.name_unique" ON "public"."Brand"("name")

ALTER TABLE "public"."_FitComponent" ADD FOREIGN KEY ("A")REFERENCES "public"."Fit"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FitComponent" ADD FOREIGN KEY ("B")REFERENCES "public"."Item"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ClosetContent" ADD FOREIGN KEY ("A")REFERENCES "public"."Closet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ClosetContent" ADD FOREIGN KEY ("B")REFERENCES "public"."Item"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200902085842-up..20200902200206-up
--- datamodel.dml
+++ datamodel.dml
@@ -1,11 +1,12 @@
 generator client {
-  provider = "prisma-client-js"
+  provider             = "prisma-client-js"
+  experimentalFeatures = ["connectOrCreate"]
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Account {
   id                 Int       @default(autoincrement()) @id
@@ -98,9 +99,9 @@
 }
 model Brand {
   id   Int     @default(autoincrement()) @id
-  name String
+  name String  @unique
   logo String?
   desc String?
 }
@@ -113,15 +114,13 @@
   year     Int?
   size     String?
   colour   Colour[]
   Sale     String?
+  archive  Boolean?
   repair   Boolean?
-  qual     Qual?
-  grail    Closet?  @relation("ClosetGrails", fields: [grailId], references: [id])
-  grailId  Int?
-  closet   Closet?  @relation("ClosetContent", fields: [closetId], references: [id])
+  closet   Closet[] @relation("ClosetContent", fields: [closetId], references: [id])
   closetId Int?
-  fit      Fit?     @relation("FitComponent", fields: [fitId], references: [id])
+  fit      Fit[]    @relation("FitComponent", fields: [fitId], references: [id])
   fitId    Int?
   user     User?    @relation("ItemRelation", fields: [userId], references: [id])
   userId   Int?
 }
```


