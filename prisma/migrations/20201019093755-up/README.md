# Migration `20201019093755-up`

This migration has been generated by Andrew Lovett-Barron at 10/19/2020, 11:37:55 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Comment" ADD COLUMN "created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN "updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP

ALTER TABLE "public"."Fit" ADD COLUMN "created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN "updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP

ALTER TABLE "public"."Item" ADD COLUMN "created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN "updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP

ALTER TABLE "public"."Media" ADD COLUMN "created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN "updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN "userId" integer   ,
ALTER COLUMN "insta_id" DROP NOT NULL

CREATE TABLE "public"."Style" (
"id" SERIAL,
"description" text   NOT NULL ,
"brandId" integer   ,
"created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"fitId" integer   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_FitToStyle" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL 
)

CREATE TABLE "public"."_BrandToStyle" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL 
)

CREATE UNIQUE INDEX "_FitToStyle_AB_unique" ON "public"."_FitToStyle"("A", "B")

CREATE INDEX "_FitToStyle_B_index" ON "public"."_FitToStyle"("B")

CREATE UNIQUE INDEX "_BrandToStyle_AB_unique" ON "public"."_BrandToStyle"("A", "B")

CREATE INDEX "_BrandToStyle_B_index" ON "public"."_BrandToStyle"("B")

ALTER TABLE "public"."Style" ADD FOREIGN KEY ("brandId")REFERENCES "public"."Brand"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Style" ADD FOREIGN KEY ("fitId")REFERENCES "public"."Fit"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."_FitToStyle" ADD FOREIGN KEY ("A")REFERENCES "public"."Fit"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FitToStyle" ADD FOREIGN KEY ("B")REFERENCES "public"."Style"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BrandToStyle" ADD FOREIGN KEY ("A")REFERENCES "public"."Brand"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BrandToStyle" ADD FOREIGN KEY ("B")REFERENCES "public"."Style"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Media" ADD FOREIGN KEY ("fitId")REFERENCES "public"."users"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201013171019-up..20201019093755-up
--- datamodel.dml
+++ datamodel.dml
@@ -4,9 +4,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Account {
   id                 Int       @id @default(autoincrement())
@@ -41,14 +41,14 @@
 }
 model User {
   id               Int       @id @default(autoincrement())
+  createdAt        DateTime  @default(now()) @map(name: "created_at")
+  updatedAt        DateTime  @default(now()) @map(name: "updated_at")
   name             String?
   email            String?   @unique
   emailVerified    DateTime? @map(name: "email_verified")
   image            String?
-  createdAt        DateTime  @default(now()) @map(name: "created_at")
-  updatedAt        DateTime  @default(now()) @map(name: "updated_at")
   username         String?   @unique
   fit              Fit[]     @relation("FitRelation")
   item             Item[]    @relation("ItemRelation")
   closet           Closet[]  @relation("ClosetRelation")
@@ -59,8 +59,9 @@
   profilepage      Boolean   @default(true)
   Comment Comment[]
+  Media   Media[]   @relation("UserMediaRelationship")
   @@map(name: "users")
 }
 model VerificationRequest {
@@ -74,29 +75,36 @@
   @@map(name: "verification_requests")
 }
 model Media {
-  id          Int     @id @default(autoincrement())
-  insta_id    String  @unique
+  id          Int      @id @default(autoincrement())
+  createdAt   DateTime @default(now()) @map(name: "created_at")
+  updatedAt   DateTime @default(now()) @map(name: "updated_at")
+  insta_id    String?  @unique
   username    String?
   timestamp   Int
   image       String
-  cloudinary  String  @default("")
+  cloudinary  String   @default("")
   url         String
   description String
-  fit         Fit?    @relation("MediaRelationship", fields: [fitId], references: [id])
+  fit         Fit?     @relation("MediaRelationship", fields: [fitId], references: [id])
   fitId       Int?
+  user        User?    @relation("UserMediaRelationship", fields: [fitId], references: [id])
+  userId      Int?
 }
 model Fit {
   id         Int       @id @default(autoincrement())
+  createdAt  DateTime  @default(now()) @map(name: "created_at")
+  updatedAt  DateTime  @default(now()) @map(name: "updated_at")
   media      Media     @relation("MediaRelationship")
   components Item[]    @relation("FitComponent")
   desc       String?
   temp       String?
   user       User?     @relation("FitRelation", fields: [userId], references: [id])
   userId     Int?
   Comment    Comment[]
+  style      Style[]
 }
 model Closet {
   id     Int    @id @default(autoincrement())
@@ -107,46 +115,62 @@
   userId Int?
 }
 model Brand {
-  id   Int     @id @default(autoincrement())
-  name String  @unique
-  logo String?
-  desc String?
-  Item Item[]
+  id    Int     @id @default(autoincrement())
+  name  String  @unique
+  logo  String?
+  desc  String?
+  Item  Item[]
+  trend Style[]
 }
 model Item {
-  id       Int      @id @default(autoincrement())
-  type     ItemType
-  photo    String?
-  brand    Brand    @relation(fields: [brandId], references: [id])
-  model    String
-  year     Int?
-  size     String?
-  colour   Colour[]
-  sale     String?
-  archive  Boolean?
-  repair   Boolean?
-  closet   Closet[] @relation("ClosetContent", fields: [closetId], references: [id])
-  closetId Int?
-  fit      Fit[]    @relation("FitComponent", fields: [fitId], references: [id])
-  fitId    Int?
-  user     User?    @relation("ItemRelation", fields: [userId], references: [id])
-  userId   Int?
-  Closet   Closet?  @relation("ClosetGrails", fields: [closetId], references: [id])
-  brandId  Int
+  id        Int      @id @default(autoincrement())
+  createdAt DateTime @default(now()) @map(name: "created_at")
+  updatedAt DateTime @default(now()) @map(name: "updated_at")
+  type      ItemType
+  photo     String?
+  brand     Brand    @relation(fields: [brandId], references: [id])
+  brandId   Int
+  model     String
+  year      Int?
+  size      String?
+  colour    Colour[]
+  sale      String?
+  archive   Boolean?
+  repair    Boolean?
+  closet    Closet[] @relation("ClosetContent", fields: [closetId], references: [id])
+  closetId  Int?
+  fit       Fit[]    @relation("FitComponent", fields: [fitId], references: [id])
+  fitId     Int?
+  user      User?    @relation("ItemRelation", fields: [userId], references: [id])
+  userId    Int?
+  Closet    Closet?  @relation("ClosetGrails", fields: [closetId], references: [id])
 }
 model Comment {
-  id      Int    @id @default(autoincrement())
-  user    User   @relation(fields: [userId], references: [id])
-  fit     Fit    @relation(fields: [fitId], references: [id])
-  userId  Int
-  fitId   Int
-  comment String
+  id        Int      @id @default(autoincrement())
+  createdAt DateTime @default(now()) @map(name: "created_at")
+  updatedAt DateTime @default(now()) @map(name: "updated_at")
+  user      User     @relation(fields: [userId], references: [id])
+  fit       Fit      @relation(fields: [fitId], references: [id])
+  userId    Int
+  fitId     Int
+  comment   String
 }
+model Style {
+  id          Int      @id @default(autoincrement())
+  description String
+  brand       Brand[]  @relation(fields: [brandId], references: [id])
+  brandId     Int?
+  createdAt   DateTime @default(now()) @map(name: "created_at")
+  updatedAt   DateTime @default(now()) @map(name: "updated_at")
+  fit         Fit[]    @relation(fields: [fitId], references: [id])
+  fitId       Int?
+}
+
 enum ItemType {
   BAG
   SHOE
   JACKET
```


