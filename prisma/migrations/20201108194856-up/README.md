# Migration `20201108194856-up`

This migration has been generated by Andrew Lovett-Barron at 11/8/2020, 8:48:56 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Comment" ADD COLUMN "reviewId" integer   

ALTER TABLE "public"."Item" ADD COLUMN "reviewId" integer   

ALTER TABLE "public"."Media" ADD COLUMN "reviewId" integer   

ALTER TABLE "public"."Style" ADD COLUMN "reviewId" integer   

CREATE TABLE "public"."Review" (
"id" SERIAL,
"title" text   NOT NULL ,
"review" text   NOT NULL ,
"faq" text []  ,
"status" "Status"  NOT NULL DEFAULT E'PENDING',
"slug" text   NOT NULL ,
"userId" integer   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "Item_reviewId_unique" ON "public"."Item"("reviewId")

ALTER TABLE "public"."Review" ADD FOREIGN KEY ("userId")REFERENCES "public"."users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Comment" ADD FOREIGN KEY ("reviewId")REFERENCES "public"."Review"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Item" ADD FOREIGN KEY ("reviewId")REFERENCES "public"."Review"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Media" ADD FOREIGN KEY ("reviewId")REFERENCES "public"."Review"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Style" ADD FOREIGN KEY ("reviewId")REFERENCES "public"."Review"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201105215903-up..20201108194856-up
--- datamodel.dml
+++ datamodel.dml
@@ -4,9 +4,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Account {
   id                 Int       @id @default(autoincrement())
@@ -71,8 +71,9 @@
   Comment Comment[]
   Media   Media[]   @relation("UserMediaRelationship")
+  Review Review[]
   @@map(name: "users")
 }
 model VerificationRequest {
@@ -103,8 +104,10 @@
   fit         Fit?        @relation("MediaRelationship", fields: [fitId], references: [id])
   fitId       Int?
   user        User?       @relation("UserMediaRelationship", fields: [userId], references: [id])
   userId      Int?
+  Review      Review?     @relation(fields: [reviewId], references: [id])
+  reviewId    Int?
 }
 model Fit {
   id         Int       @id @default(autoincrement())
@@ -161,8 +164,10 @@
   userId    Int?
   Closet    Closet?     @relation("ClosetGrails", fields: [closetId], references: [id])
   brandId   Int
   layers    ItemLayer[] @relation("ItemItemLayer")
+  Review    Review?     @relation(fields: [reviewId], references: [id])
+  reviewId  Int?
 }
 model Comment {
   id        Int      @id @default(autoincrement())
@@ -172,8 +177,10 @@
   fit       Fit      @relation(fields: [fitId], references: [id])
   userId    Int
   fitId     Int
   comment   String
+  Review    Review?  @relation(fields: [reviewId], references: [id])
+  reviewId  Int?
 }
 model Style {
   id          Int      @id @default(autoincrement())
@@ -186,8 +193,10 @@
   fit         Fit[]    @relation(fields: [fitId], references: [id])
   fitId       Int?
   User        User?    @relation(fields: [userId], references: [id])
   userId      Int?
+  Review      Review?  @relation(fields: [reviewId], references: [id])
+  reviewId    Int?
 }
 model ItemLayer {
   id      Int    @id @default(autoincrement())
@@ -199,8 +208,24 @@
   y       Float
   r       Float
 }
+model Review {
+  id      Int       @id @default(autoincrement())
+  user    User      @relation(fields: [userId], references: [id])
+  title   String
+  review  String
+  item    Item
+  faq     String[]
+  media   Media[]
+  tags    Style[]
+  status  Status    @default(value: PENDING)
+  Comment Comment[]
+  slug    String
+
+  userId Int
+}
+
 enum ItemType {
   BAG
   SHOE
   JACKET
```


