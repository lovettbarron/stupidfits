# Migration `20201116223625-up`

This migration has been generated by Andrew Lovett-Barron at 11/16/2020, 11:36:25 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Comment" ADD COLUMN "collectionId" integer   

ALTER TABLE "public"."Fit" ADD COLUMN "collectionId" integer   

ALTER TABLE "public"."Style" ADD COLUMN "collectionId" integer   

CREATE TABLE "public"."Collection" (
"id" SERIAL,
"userId" integer   NOT NULL ,
"title" text   NOT NULL ,
"description" text   ,
"slug" text   NOT NULL ,
"public" boolean   NOT NULL DEFAULT false,
"published" boolean   NOT NULL DEFAULT false,
"created_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updated_at" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."Collection" ADD FOREIGN KEY ("userId")REFERENCES "public"."users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Comment" ADD FOREIGN KEY ("collectionId")REFERENCES "public"."Collection"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Fit" ADD FOREIGN KEY ("collectionId")REFERENCES "public"."Collection"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Style" ADD FOREIGN KEY ("collectionId")REFERENCES "public"."Collection"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201116190509-up..20201116223625-up
--- datamodel.dml
+++ datamodel.dml
@@ -4,9 +4,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Account {
   id                 Int       @id @default(autoincrement())
@@ -73,8 +73,9 @@
   Media   Media[]   @relation("UserMediaRelationship")
   Review Review[]
   @@map(name: "users")
+  Collection Collection[]
 }
 model VerificationRequest {
   id         Int      @id @default(autoincrement())
@@ -109,20 +110,22 @@
   reviewId    Int?
 }
 model Fit {
-  id         Int       @id @default(autoincrement())
-  createdAt  DateTime  @default(now()) @map(name: "created_at")
-  updatedAt  DateTime  @default(now()) @map(name: "updated_at")
-  media      Media[]   @relation("MediaRelationship")
-  components Item[]    @relation("FitComponent")
-  desc       String?
-  temp       String?
-  user       User?     @relation("FitRelation", fields: [userId], references: [id])
-  userId     Int?
-  status     Status    @default(value: PENDING)
-  Comment    Comment[]
-  style      Style[]
+  id           Int         @id @default(autoincrement())
+  createdAt    DateTime    @default(now()) @map(name: "created_at")
+  updatedAt    DateTime    @default(now()) @map(name: "updated_at")
+  media        Media[]     @relation("MediaRelationship")
+  components   Item[]      @relation("FitComponent")
+  desc         String?
+  temp         String?
+  user         User?       @relation("FitRelation", fields: [userId], references: [id])
+  userId       Int?
+  status       Status      @default(value: PENDING)
+  Comment      Comment[]
+  style        Style[]
+  Collection   Collection? @relation(fields: [collectionId], references: [id])
+  collectionId Int?
 }
 model Closet {
   id     Int    @id @default(autoincrement())
@@ -169,34 +172,38 @@
   reviewId  Int?
 }
 model Comment {
-  id        Int      @id @default(autoincrement())
-  createdAt DateTime @default(now()) @map(name: "created_at")
-  updatedAt DateTime @default(now()) @map(name: "updated_at")
-  user      User     @relation(fields: [userId], references: [id])
-  fit       Fit?     @relation(fields: [fitId], references: [id])
-  userId    Int
-  fitId     Int?
-  comment   String
-  Review    Review?  @relation(fields: [reviewId], references: [id])
-  reviewId  Int?
+  id           Int         @id @default(autoincrement())
+  createdAt    DateTime    @default(now()) @map(name: "created_at")
+  updatedAt    DateTime    @default(now()) @map(name: "updated_at")
+  user         User        @relation(fields: [userId], references: [id])
+  fit          Fit?        @relation(fields: [fitId], references: [id])
+  userId       Int
+  fitId        Int?
+  comment      String
+  Review       Review?     @relation(fields: [reviewId], references: [id])
+  reviewId     Int?
+  Collection   Collection? @relation(fields: [collectionId], references: [id])
+  collectionId Int?
 }
 model Style {
-  id          Int      @id @default(autoincrement())
-  name        String
-  description String
-  brand       Brand[]  @relation(fields: [brandId], references: [id])
-  brandId     Int?
-  createdAt   DateTime @default(now()) @map(name: "created_at")
-  updatedAt   DateTime @default(now()) @map(name: "updated_at")
-  fit         Fit[]    @relation(fields: [fitId], references: [id])
-  fitId       Int?
-  User        User?    @relation(fields: [userId], references: [id])
-  userId      Int?
-  Review      Review?  @relation(fields: [reviewId], references: [id])
-  reviewId    Int?
+  id           Int         @id @default(autoincrement())
+  name         String
+  description  String
+  brand        Brand[]     @relation(fields: [brandId], references: [id])
+  brandId      Int?
+  createdAt    DateTime    @default(now()) @map(name: "created_at")
+  updatedAt    DateTime    @default(now()) @map(name: "updated_at")
+  fit          Fit[]       @relation(fields: [fitId], references: [id])
+  fitId        Int?
+  User         User?       @relation(fields: [userId], references: [id])
+  userId       Int?
+  Review       Review?     @relation(fields: [reviewId], references: [id])
+  reviewId     Int?
+  Collection   Collection? @relation(fields: [collectionId], references: [id])
+  collectionId Int?
 }
 model ItemLayer {
   id      Int    @id @default(autoincrement())
@@ -228,8 +235,24 @@
   userId Int
 }
+model Collection {
+  id          Int       @id @default(autoincrement())
+  user        User      @relation(fields: [userId], references: [id])
+  userId      Int
+  fits        Fit[]
+  title       String
+  description String?
+  slug        String
+  public      Boolean   @default(false)
+  published   Boolean   @default(false)
+  createdAt   DateTime  @default(now()) @map(name: "created_at")
+  updatedAt   DateTime  @default(now()) @map(name: "updated_at")
+  tags        Style[]
+  Comment     Comment[]
+}
+
 enum ReviewFocus {
   ITEM
   STYLE
   FIT
```


