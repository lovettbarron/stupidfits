# Migration `20201119220813-up`

This migration has been generated by Andrew Lovett-Barron at 11/19/2020, 11:08:13 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Fit" DROP CONSTRAINT "Fit_collectionId_fkey"

ALTER TABLE "public"."Fit" DROP COLUMN "collectionId"

CREATE TABLE "public"."_CollectionToFit" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL 
)

CREATE UNIQUE INDEX "_CollectionToFit_AB_unique" ON "public"."_CollectionToFit"("A", "B")

CREATE INDEX "_CollectionToFit_B_index" ON "public"."_CollectionToFit"("B")

ALTER TABLE "public"."_CollectionToFit" ADD FOREIGN KEY ("A")REFERENCES "public"."Collection"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_CollectionToFit" ADD FOREIGN KEY ("B")REFERENCES "public"."Fit"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201119143248-up..20201119220813-up
--- datamodel.dml
+++ datamodel.dml
@@ -4,9 +4,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Account {
   id                 Int       @id @default(autoincrement())
@@ -112,22 +112,22 @@
   reviewId    Int?
 }
 model Fit {
-  id           Int         @id @default(autoincrement())
-  createdAt    DateTime    @default(now()) @map(name: "created_at")
-  updatedAt    DateTime    @default(now()) @map(name: "updated_at")
-  media        Media[]     @relation("MediaRelationship")
-  components   Item[]      @relation("FitComponent")
-  desc         String?
-  temp         String?
-  user         User?       @relation("FitRelation", fields: [userId], references: [id])
-  userId       Int?
-  status       Status      @default(value: PENDING)
-  Comment      Comment[]
-  style        Style[]
-  Collection   Collection? @relation(fields: [collectionId], references: [id])
-  collectionId Int?
+  id         Int          @id @default(autoincrement())
+  createdAt  DateTime     @default(now()) @map(name: "created_at")
+  updatedAt  DateTime     @default(now()) @map(name: "updated_at")
+  media      Media[]      @relation("MediaRelationship")
+  components Item[]       @relation("FitComponent")
+  desc       String?
+  temp       String?
+  user       User?        @relation("FitRelation", fields: [userId], references: [id])
+  userId     Int?
+  status     Status       @default(value: PENDING)
+  Comment    Comment[]
+  style      Style[]
+  Collection Collection[]
+
 }
 model Closet {
   id     Int    @id @default(autoincrement())
```


