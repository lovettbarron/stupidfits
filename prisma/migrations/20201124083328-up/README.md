# Migration `20201124083328-up`

This migration has been generated by Andrew Lovett-Barron at 11/24/2020, 9:33:28 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Collection" ADD COLUMN "oneperuser" boolean   NOT NULL DEFAULT false

ALTER TABLE "public"."Fit" ADD COLUMN "battleId" integer   

ALTER TABLE "public"."Fit" ADD FOREIGN KEY ("battleId")REFERENCES "public"."Battle"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201123181355-up..20201124083328-up
--- datamodel.dml
+++ datamodel.dml
@@ -4,9 +4,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Account {
   id                 Int       @id @default(autoincrement())
@@ -130,8 +130,10 @@
   style         Style[]
   Collection    Collection[]
   BattleMatchup BattleMatchup[]
   BattleVote    BattleVote[]
+  Battle        Battle?         @relation(fields: [battleId], references: [id])
+  battleId      Int?
 }
 model Closet {
   id     Int    @id @default(autoincrement())
@@ -242,22 +244,24 @@
   userId Int
 }
 model Collection {
-  id          Int       @id @default(autoincrement())
-  user        User      @relation(fields: [userId], references: [id])
+  id          Int     @id @default(autoincrement())
+  user        User    @relation(fields: [userId], references: [id])
   userId      Int
   fits        Fit[]
   title       String
   description String?
   slug        String
-  public      Boolean   @default(false)
-  published   Boolean   @default(false)
-  createdAt   DateTime  @default(now()) @map(name: "created_at")
-  updatedAt   DateTime  @default(now()) @map(name: "updated_at")
-  tags        Style[]
-  Comment     Comment[]
-  Battle      Battle[]
+  public      Boolean @default(false)
+  published   Boolean @default(false)
+  oneperuser  Boolean @default(false)
+
+  createdAt DateTime  @default(now()) @map(name: "created_at")
+  updatedAt DateTime  @default(now()) @map(name: "updated_at")
+  tags      Style[]
+  Comment   Comment[]
+  Battle    Battle[]
 }
 model Notification {
   id        Int      @id @default(autoincrement())
@@ -277,8 +281,9 @@
   endDate     DateTime   @default(now())
   rules       String
   type        BattleType @default(value: POPULAR)
   activeRound Int        @default(value: 0)
+  winners     Fit[]
   user          User            @relation(fields: [userId], references: [id])
   judges        User[]          @relation(name: "battleJudges")
   collection    Collection      @relation(fields: [collectionId], references: [id])
```


