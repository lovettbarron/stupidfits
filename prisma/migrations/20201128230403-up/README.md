# Migration `20201128230403-up`

This migration has been generated by Andrew Lovett-Barron at 11/29/2020, 12:04:03 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "Collection" DROP CONSTRAINT "Collection_groupId_fkey"

ALTER TABLE "Invite" DROP CONSTRAINT "Invite_groupId_fkey"

ALTER TABLE "_memberGroup" DROP CONSTRAINT "_memberGroup_A_fkey"

ALTER TABLE "Collection" DROP COLUMN "groupId",
ADD COLUMN     "groupId" INTEGER

ALTER TABLE "Invite" DROP COLUMN "groupId",
ADD COLUMN     "groupId" INTEGER

ALTER TABLE "_memberGroup" DROP COLUMN "A",
ADD COLUMN     "A" INTEGER NOT NULL

ALTER TABLE "groups" DROP CONSTRAINT "groups_pkey",
DROP COLUMN "id",
ADD COLUMN "id" SERIAL,
ADD PRIMARY KEY ("id")

ALTER TABLE "Collection" ADD FOREIGN KEY("groupId")REFERENCES "groups"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "Invite" ADD FOREIGN KEY("groupId")REFERENCES "groups"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "_memberGroup" ADD FOREIGN KEY("A")REFERENCES "groups"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201128215324-up..20201128230403-up
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -9,9 +9,9 @@
 }
 // datasource db {
 //   provider = "postgresql"
-//   url = "***"
+//   url = "***"
 // }
 model Account {
   id                 Int       @id @default(autoincrement())
@@ -249,9 +249,9 @@
   userId Int
 }
 model Group {
-  id          String   @id @default(uuid())
+  id          Int      @id @default(autoincrement())
   name        String
   user        User     @relation("adminGroup", fields: [userId], references: [id])
   links       String[]
   slug        String
@@ -273,9 +273,9 @@
   email        String?
   collection   Collection? @relation("inviteCollection", fields: [collectionId], references: [id])
   group        Group?      @relation("inviteGroup", fields: [groupId], references: [id])
   collectionId Int?
-  groupId      String?
+  groupId      Int?
 }
 model Collection {
   id          Int     @id @default(autoincrement())
@@ -294,9 +294,9 @@
   updatedAt DateTime @default(now()) @map(name: "updated_at")
   tags      Style[]
   Battle    Battle[]
   Invite    Invite[] @relation("inviteCollection")
-  groupId   String?
+  groupId   Int?
 }
 model Notification {
   id        Int      @id @default(autoincrement())
```


